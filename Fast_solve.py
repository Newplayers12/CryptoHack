from sage.all import *
from Crypto.Util.number import GCD
import dc

B = int({"B": "0xa7e9ea2aa0e6fe816a17e9fac1b55d7668cdb42c5c5736db9cfa5a3d5b3d77cebfec5a9b5586b1f2ed5e303e527c3257f479ff7a8295e5de4447efc95c32dc6fe722062d1f531187b2d7f14a27ba6e6d957becac4a91565a6151403e9724a0162a1128ed1e8389508e57f09a3c0930464835f62db8fc6314c4d4881f823a9850d1715c3ec53de69c915dc9d4feea8982cd1c440bdcb99bb08ccc787e2f0c13f55fbea150dcf638da5f9912f07e15fe1bfa"}['B'][2:], 16)

data = {"iv": "1f65e12874f86f9bef3aabd938ac59bc", "encrypted": "189cc633a193bd238b1ae11363f522c813eafdb12750510737664fcad3450e72"}
data_tmp = {"iv": "eea1e014187bb3ef179f53d62331eaa2", "encrypted": "ed438097351f144560e779818fc88aaad1b5b262d28be94b497bff0d0e4cf6e92aba1b5d6f292921d462c3df01e5481361b6ec23c90a1f28b49b0aa9317422cbb8e5b349b8fe775585283d9703f0b585"}
R = IntegerModRing(p)


p = 0xffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff
b = 1919572943691512325783103720167834163677411292709378502535498859989993544026380143919501049584589675317643993465536543895780854808442293000014297210200227069779643763121704810281976733978781152126062646602812482025293137787739116693980988513420732289020477701182639042794562638875881378349771734410919106042203493166198706573467903966100368713572415175654342828296086659529676015616513470105470901979846373335352656586302787870238998914215908919919219987614105175
A = 0xaf5cfc7da4eaf7a07202e59ca66400dc25d7c81a3d6144fff4dde05d40da4d53a64a0a081118028bbabc00c683fe0a04720e46c8c5170c588bbf78a7ea24ecc00532ccafb500d567ddbc7caccd660d98cf1fe1500667ecd65aa23c256fa11fb53ffab89cc3c46222140b83ad92e0645b587135a87faaaecdb635fcf4dfd328b9d5130096fa79f98271919947ddbb25004708c50d4f5fa911cce31b640f3239a38d69aa05f54f70999bd6c1ea167e79e70bf8ad67b85f43551b6a077527959be6
data_tmp = {"iv": "98bfa4e2ba77808a0a4bf19477918228", "encrypted": "c5b096d3e331abafe0a5dd65854ba9dabd9f42a03cd6d258a3594e210481a870f4a5ccc618184d031f3eeeda636a249e"}

shared_secret = pow(A, b, p)

print(dc.decrypt_flag(shared_secret, *data_tmp.values()))

    